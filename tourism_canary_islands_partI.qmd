---
title: "Tourism Canary Islands"
author: "O.Q.R."
format: html
editor: visual
---

# Packages.

```{r}
library(tidyverse)
library(janitor)
library(gt)
library(gtExtras)
library(ggtext)
library(giscoR)
library(sf)
library(patchwork)
library(ggiraph)
library(scales)
library(htmltools)
```

# Introduction.

Located at the crossover of three continents, the Canary Islands are well known as one of the main tourists destinations for Europeans. Often referred to as <em>The Fortunate Islands</em> in ancient times, the islands enjoy a mild climate that allows for outdoor activities all year round. Locals and visitors can explore the many natural attractions in the islands, including diverse and stunning landscapes, four national parks, volcanoes, rainforests, long sandy beaches, a rich and extraordinary gastronomy, etc., all wrapped in an easy-going way of living that make the Canary Islands a dream destination for many.

In fact, in 2023, the Canary Islands were the EU region with the highest number of nights spent in tourist accommodations, with over 95 millions, surpassing popular tourist destinations such as Adriatic Croatia, Île-de-France (where Paris is), Catalonia (Barcelona), Veneto (Venice), Balearic Islands, Tuscany (Florence) or Lazio (Rome).

Although the origins of the tourist industry in the Canary Islands can be traced back to the \[second half of the XIX century\](<https://podcasts.apple.com/us/podcast/los-inicios-del-turismo-en-canarias/id1609755450?i=1000550870959>), its large-scale development didn't take off until the 1960s and 1970s, gradually becoming the islands' main industry.

In this post, I will go through some of the key tourism indicators in the Canary Islands and how they have evolved over recent years. This will give us a snapshot of the current state of this industry in the archipelago, and will set the stage to explore its socioeconomic impact in the islands (in a future post).

So, let's dive right in!

# Data.

For each dataset, I explore the different values each variable I am interested in takes using the function `unique()`.

## Nights spent at tourist accommodation establishments in the EU.

I will get this data from Eurostat.

```{r}
eu_nights_spent_raw <- get_eurostat(id = "tour_occ_nin2m", type = "code", stringsAsFactors = TRUE)
#write_csv(eu_nights_spent_raw, "Data/eu_nights_spent_raw.csv")
```

```{r}
# having a look at the first 6 rows
head(eu_nights_spent_raw)
```

```{r}
# glimpse at the data
glimpse(eu_nights_spent_raw)
```

The dataset contains 294305 rows and 8 columns. I am only interested in regional data for the year 2023, so I will select only that data.

```{r}
# data for the year 2023
eu_nights_spent_23 <- eu_nights_spent_raw %>%
  filter(nchar(as.character(geo)) == 4) %>%
  label_eurostat(fix_duplicated = TRUE) %>%
  filter(c_resid == "Total",
         month == "Total",
         unit %in% c("Number", "Per square kilometre", "Per thousand inhabitants"),
         year(TIME_PERIOD) == 2023) %>%
  select(-freq, -c_resid, -nace_r2, -month)
```

```{r}
# having a look at the first 6 rows
head(eu_nights_spent_23)
```

```{r}
# glimpse at the clean data
glimpse(eu_nights_spent_23)
```

```{r}
# checking for missing values
eu_nights_spent_23 %>%
  summarise_all(~sum(is.na(.)))
```

There are no missing values in the clean data.

```{r}
# summary of the data
summary(eu_nights_spent_23)
```

## Total number of tourists arrived to the Canary Islands.

I will download the data from Instituto Canario de Estadística (ISTAC).

```{r}
# downloading the data
tourists_can_raw <- read_csv("https://datos.canarias.es/api/estadisticas/statistical-resources/v1.0/datasets/ISTAC/E16028B_000003/~latest.csv")
```

I will take a look at the first 6 rows and at the structure of the data.

```{r}
head(tourists_can_raw)
```

```{r}
glimpse(tourists_can_raw)
```

The dataset contains 14480 rows and 15 columns. I will start by cleaning column names, selecting the data I am interested in, create a new columns (date, year, month) and dropping columns I don't need.

```{r}
tourists_can <- tourists_can_raw %>%
  clean_names() %>%
  filter(medidas_number_es == "Turistas") %>%
  separate(time_period_number_es, into = c("month", "year"), sep = "/") %>%
  mutate(date = ym(paste(year, month, sep = "-")),
         across(c(month, year), ~as.numeric(.))) %>%
  select(date, year, month, country = lugar_residencia_number_es, tourists = obs_value)
```

I'll check now for missing values.

```{r}
tourists_can %>%
  summarise_all(~sum(is.na(.)))
```

There are 33 missing values on the <b>tourists</b> column. I'll take a closer look at them.

```{r}
tourists_can %>%
  filter(is.na(tourists)) %>%
  print(n = 40)
```

All the missing values corresponds to the first months after the lockdown due to the COVID-19, where very few or no tourists arrived to the Canary Islands.

I'll now have a look at a summary of the data.

```{r}
summary(tourists_can)
```

The earliest data point in the data corresponds to Jan 2010, and the latest to Jan 2025.

In the month with the lowest amount of arrivals had 16 tourists arriving to the islands. On the other end, the month with the highest number recorded over 1.7 millions arrivals. The mean number during the period in the dataset is 196519.

<br>

## Tourists by island.

This dataset contains the number of tourists arrived by island and place of origin. I will download it from ISTAC.

```{r}
tour_by_island_raw <- read_csv("https://datos.canarias.es/api/estadisticas/statistical-resources/v1.0/datasets/ISTAC/E16028B_000011/~latest.csv")
```

I will take a look at the first rows and a glimpse at the dataset.

```{r}
head(tour_by_island_raw)
```

```{r}
glimpse(tour_by_island_raw)
```

The dataset contains 162900 rows and 15 columns. I will follow a similar procedure as before to clean column names, create new variables, etc.

```{r}
tour_by_island <- tour_by_island_raw %>%
  clean_names() %>%
  separate(time_period_number_es, into = c("month", "year"), sep = "/") %>%
  filter(tipo_viajero_number_es == "Turistas principales",
         medidas_number_es == "Turistas") %>%
  mutate(across(c(month, year), ~as.numeric(.)),
         date = lubridate::ym(paste(year, month, sep = "-"))) %>%
  select(date, year, month, country = lugar_residencia_number_es,
         island = territorio_number_es, tourists = obs_value) %>%
  distinct()
```

I'll have a look at the first 6 rows of the clean data, then at 15 random rows and, finally, a glimpse.

```{r}
head(tour_by_island)
```

```{r}
sample_n(tour_by_island, size = 15)
```

```{r}
glimpse(tour_by_island)
```

The clean data contains now 10860 rows and 6 columns. I'll now check for missing data.

```{r}
tour_by_island %>%
  summarise_all(~sum(is.na(.)))
```

There are 293 missing values in the tourists column. I suspect it could be due to the COVID-19 restrictions and Spanish borders closure at the beginning of the pandemic.

```{r}
tour_by_island %>%
  filter(is.na(tourists)) %>%
  arrange(date)
```

Well, it seems that the missing values are not only in the dates where the pandemic hit.

```{r}
tour_by_island %>%
  filter(is.na(tourists)) %>%
  group_by(year) %>%
  summarise(missing_values = n())
```

When looking at the number of missing values by year, 2020 is by far the year with the highest number of missing values, which corresponds with the beginning of the COVID-19 pandemic. I'll take a closer look.

```{r}
tour_by_island %>%
  filter(is.na(tourists),
         year == 2020) %>%
  arrange(date)
```

```{r}
tour_by_island %>%
  filter(is.na(tourists),
         year == 2020) %>%
  arrange(date) %>%
  tail()
```

It does seem that the pandemic accounts for most of the missing values in this column. There were restrictive measures implemented in the Canary Islands that severely affected the touristic sector.

```{r}
tour_by_island %>%
  filter(is.na(tourists),
         country == "Total") %>%
  group_by(year) %>%
  summarise(missing_values = n())
```

```{r}
tour_by_island %>%
  filter(is.na(tourists),
         country == "Total",
         year == 2020) %>%
  print(n = 10)
```

If I look at the total number of tourists by island, the only year with missing values is 2020, and they correspond with the months of April and May, when no tourists (or very few) arrived to the islands.<br>

```{r}
unique(tour_by_island$island)
```

The dataset contains data for five islands, with La Gomera and El Hierro missing. I will calculate the values for these islands (together) using the total number in the previous dataset (\`tourists_can\`).

<br>

```{r}
# checking the countries of origin in the tourists_can dataset
unique(tourists_can$country)
```

```{r}
# checking the countries of origin in the tour_by_island dataset
unique(tour_by_island$country)
```

```{r}
# checking countries of origin that are not present in both datasets
setdiff(unique(tourists_can$country), unique(tour_by_island$country))
```

In the dataset containing the total number of tourists visiting the Canary Islands (all islands combined, `tourists_can` dataset) there are a bigger number of countries as countries of origin than in the dataset containing the data disaggregated by island (`tour_by_island` dataset). Denmark, Norway, Sweden, and Finland are aggregated as <i>Países Nórdicos</i> (Nordic countries) in the `tour_by_island` dataset. Switzerland is also absent in the this last dataset. This is the first thing to fix before calculating the tourists per country visiting La Gomera & El Hierro (combined).

```{r}
# tourists arrived to La Gomera & El Hierro (combined)

lg_eh <- tourists_can %>%
  # adjusting the categories in the country column
  mutate(country_adj = case_when(country %in% c("Dinamarca", "Finlandia", "Noruega", "Suecia") ~ "Países Nórdicos",
                                 country == "Suiza" ~ "Total",
                                 .default = country)) %>%
  group_by(date, year, month, country_adj) %>%
  # calculating the number of tourists
  summarise(tourists_can = sum(tourists, na.rm = TRUE), .groups = "drop") %>%
  # joining with the data for all islands combined
  left_join(tour_by_island %>%
              group_by(date, year, month, country) %>%
              summarise(tourists5 = sum(tourists, na.rm = TRUE), .groups = "drop"),
            by = c("date", "year", "month", "country_adj" = "country")) %>%
  # calculating tourists arrived to La Gomera & El Hierro
  mutate(lg_eh_tourists = tourists_can - tourists5) %>%
  select(-tourists_can, -tourists5) %>%
  rename(country = country_adj)
```

I will now check that there are no negative values.

```{r}
lg_eh %>%
  filter(lg_eh_tourists < 0)
```

```{r}
lg_eh_neg <- lg_eh %>%
  filter(lg_eh_tourists < 0)
```

```{r}
# fixing negative values for individual countries
lg_eh_adj <- lg_eh %>%
  mutate(lg_eh_tourists = if_else(lg_eh_tourists < 0 &
                                    country != "Otros países o territorios del mundo (excluida España)",
                                  0, lg_eh_tourists)) %>%
  filter(lg_eh_tourists >= 0)
```

There are negative values in this recently calculated dataset. For individual countries, the negative values are -1 or -2, probably due to small differences in the original datasets fetched. In these cases, these negative values will be replaced by 0.<br>

In the rows corresponding to <i>Otros países o territorios del mundo (excluida España)</i> (Other countries and territories (excluding Spain)), the negative values likely are caused by counting Switzerland twice. I will drop these rows and calculate these values with the data already in the dataset.

```{r}
# calculating values for "Other countries..." for La Gomera & El Hierro
lg_eh_other <- lg_eh_adj %>%
  group_by(date, year, month, group = if_else(country == "Total", "Total", "countries")) %>%
  summarise(lg_eh_tourists = sum(lg_eh_tourists, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = group, values_from = lg_eh_tourists) %>%
  mutate(country = "Otros países o territorios del mundo (excluida España)",
         island = "La Gomera & El Hierro",
         tourists = Total - countries) %>%
  select(date, year, month, country, island, tourists)
```

```{r}
# joining La Gomera & El Hierro values to the rest of the islands
tour_by_island2 <- tour_by_island %>%
  bind_rows(lg_eh_adj %>%
              rename(tourists = lg_eh_tourists) %>%
              mutate(island = "La Gomera & El Hierro"),
            lg_eh_other)
```

## Average stay.

I will follow a similar process as above. I will fetch the data from ISTAC.

```{r}
# fetching data from ISTAC
average_stay_raw <- read_csv("https://datos.canarias.es/api/estadisticas/statistical-resources/v1.0/datasets/ISTAC/C00065A_000036/1.46.csv")
#write_csv(average_stay_raw, "Data/overnight_stays_raw.csv")
```

```{r}
head(average_stay_raw)
```

```{r}
glimpse(average_stay_raw)
```

```{r}
average_stay <- average_stay_raw %>%
  clean_names() %>%
  separate(col = time_period_number_es, into = c("month", "year"), sep = "/") %>%
  filter(medidas_number_es == "Estancia media",
         territorio_number_es %in% c("Canarias", "Lanzarote", "Fuerteventura", "Gran Canaria",
                                     "Tenerife", "La Gomera", "La Palma", "El Hierro"),
         !is.na(month),
         !is.na(year)) %>%
  mutate(across(c(year, month), ~as.integer(.)),
         date = ym(paste(year, month, sep = "-"))) %>%
  select(date, year, month, island = territorio_number_es, country = nacionalidad_number_es,
         stays = obs_value)
```

```{r}
head(average_stay)
```

```{r}
sample_n(average_stay, size = 15)
```

```{r}
# checking for missing values
average_stay %>%
  summarise_all(~sum(is.na(.)))
```

```{r}
average_stay %>%
  arrange(date) %>%
  filter(is.na(stays))
```

```{r}
average_stay %>%
  arrange(date) %>%
  filter(is.na(stays),
         island == "Canarias")
```

```{r}
average_stay %>%
  arrange(date) %>%
  filter(is.na(stays),
         country == "Total")
```

There are no missing values for the total amount of overnight stays for the Canary Islands. The values for this category (total number of overnight stays) by island corresponds to the COVID-19 pandemic. Thus, I will not do anything else, since I have what I want in the data.

## Daily average expenditure per tourist.

I followed a similar approach as before.

```{r}
daily_exp_raw <- read_csv("https://datos.canarias.es/api/estadisticas/statistical-resources/v1.0/datasets/ISTAC/C00028A_000011/~latest.csv")
```

```{r}
# peek at the first rows
head(daily_exp_raw)
```

```{r}
# glimpse at the data
glimpse(daily_exp_raw)
```

```{r}
# cleaning the data
daily_exp <- daily_exp_raw %>%
  clean_names() %>%
  filter(medidas_number_es == "Gasto por turista y día") %>%
  separate(col = time_period_code, into = c("year", "quarter"), sep = "-") %>%
  mutate(year = as.integer(year),
         quarter = str_extract(quarter, "\\d") %>%
           as.integer()) %>%
  select(year, quarter, concept = conceptos_gastos_turisticos_number_es,
         country = pais_residencia_number_es, avg_exp = obs_value)
```

```{r}
# checking for missing values
daily_exp %>%
  summarise_all(~sum(is.na(.)))
```

```{r}
# having a look at the rows with missing values
daily_exp %>%
  filter(is.na(avg_exp)) %>%
  print(n = 50)
```

## Total income and ADR.

I followed a similar approach as before.

```{r}
adr_raw <- read_csv("https://datos.canarias.es/api/estadisticas/statistical-resources/v1.0/datasets/ISTAC/C00065A_000033/~latest.csv")
#write_csv(adr_raw, "Data/adr_raw.csv")
```

```{r}
head(adr_raw)
```

```{r}
glimpse(adr_raw)
```

```{r}
adr <- adr_raw %>%
  clean_names() %>%
  filter(medidas_number_es %in% c("Ingresos totales", "Tarifa media diaria")) %>%
  separate(time_period_code, into = c("year", "month"), sep = "-") %>%
  mutate(month = parse_number(month),
         year = as.integer(year)) %>%
  select(year, month, territory = territorio_number_es, variable = medidas_number_es,
         obs_value)
```

```{r}
adr %>%
  summarise_all(~sum(is.na(.)))
```

```{r}
adr %>%
  filter(is.na(obs_value))
```

<br>

# Analysis.

## Tourist arrivals to the Canary Islands.

```{r}
# Tourist arrivals per year
tourists_can_2005_9 <- read_csv2("Data/yearly tourists Canary Islands 2005-9.csv")

tourists_can %>%
  filter(country == "Total",
         year < 2025) %>%
  group_by(year) %>%
  summarise(tourists = sum(tourists, na.rm = TRUE) / 1000000, .groups = "drop") %>%
  bind_rows(tourists_can_2005_9 %>%
              rename(year = Year) %>%
              mutate(tourists = tourists / 1000000)) %>%
  ggplot(aes(x = year, y = tourists)) +
  geom_rect(aes(xmin = 2007, xmax = 2013, ymin = -Inf, ymax = Inf), fill = "#dee5ec", alpha = 0.05) +
  geom_rect(aes(xmin = 2010, xmax = 2011, ymin = -Inf, ymax = Inf), fill = "#bfd7d7", alpha = 0.05) +
  geom_rect(aes(xmin = 2020, xmax = 2023, ymin = -Inf, ymax = Inf), fill = "#c4d3df", alpha = 0.025) +
  geom_line(linewidth = 1.2, colour = "blue") +
  geom_point(size = 4, shape = 21, colour = "white", fill = "blue") +
  scale_x_continuous(breaks = seq(2005, 2024, 1),
                     expand = c(0.01, 0.01)) +
  scale_y_continuous(breaks = seq(0, 20, 2),
                     labels = c("", seq(2, 20, 2)),
                     limits = c(0, 20),
                     expand = c(0, 0)) +
  labs(title = "More tourists visited the Canary Islands each year after COVID.",
       subtitle = "After a dramatic drop due to the pandemic, there was a quick recovery, with 2024 setting \nan all-time high in the number of tourists visiting the islands.",
       x = element_blank(),
       y = "Tourists (millions)",
       caption = "Data: FRONTUR & Instituto Canario de Estadística (ISTAC). | Made by Oliver Q.R.") +
  annotate(geom = "segment", x = 2007, xend = 2013, y = 0.3, colour = "grey45",
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "both")) +
  annotate(geom = "text", x = 2010, y = 0.8, colour = "black", size = 3.5, hjust = 0.5,
           label = "Global financial crisis") +
  annotate(geom = "segment", x = 2010, xend = 2011, y = 19.5, colour = "grey45",
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "both")) +
  annotate(geom = "text", x = 2010.5, y = 18.7, colour = "black", size = 3.5, hjust = 0.5,
           label = "Arab\nSpring") +
  annotate(geom = "segment", x = 2020, xend = 2023, y = 0.3, colour = "grey45", 
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "both")) +
  annotate(geom = "text", x = 2021.5, y = 1.2, colour = "black", size = 3.5, hjust = 0.5,
           label = "COVID-19 public health emergency\nof international concern") +
  annotate(geom = "curve", x = 2022.65, xend = 2023.9, y = 19, yend = 18, colour = "grey45",
           arrow = arrow(length = unit(0.2, "cm"), type = "closed"), curvature = -0.1) +
  annotate(geom = "text", x = 2021.8, y = 19.1, colour = "black", size = 4, fontface = "bold",
           label = "all-time high") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(colour = "grey97"),
        plot.title = element_text(colour = "#1c3d5a", face = "bold", size = 24),
        plot.subtitle = element_text(colour = "#6d7b8d", size = 18,
                                     margin = margin(t = 2.5, b = 15)),
        plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 12),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(margin = margin(r = 5)),
        axis.ticks = element_line(colour = "grey97"),
        axis.title.y = element_text(size = 14, family = "Cabin", colour = "#555555",
                                    margin = margin(r = 10)),
        plot.margin = margin(10, 10, 10, 10))
```

In 2005, 11.3 million tourists arrived in the Canary Islands. By 2024, this number had increased to 17.8 millions (+57.5%). Between 2005 and 2013 growth was relatively modest (+7.7%), likely due to the global financial crisis. After that, tourist arrivals soared in the period 2013-17, rising by 31.1% in just four years.<br>

After a slight drop in 2018-19, the industry was hit hard by the COVID-19 pandemic, which led to a sharp decline in arrivals due to global travel restrictions. However, there was a major rebound already by 2022, with visitor number nearly reaching the pre-pandemic levels. This upward trend continued in 2023 and 2024, with both years setting new records.

<br>

## Tourists by island in 2024.

```{r}
# Tourists by island (2024)
# tourists arrived by island in 2024
tour_by_island_2024 <- tourists_by_island %>%
  filter(country == "Total",
         year == 2024) %>%
  group_by(year, island) %>%
  summarise(tourists = sum(tourists, na.rm = TRUE)) %>%
  mutate(percent = 100 * tourists / sum(tourists)) %>%
  ungroup() %>%
  select(-year)


tour_by_island_2024 %>%
  ggplot(aes(x = percent, y = fct_reorder(island, percent), fill = island)) +
  geom_col(width = 0.7) +
  scale_x_continuous(limits = c(0, 50),
                     expand = c(0.01, 0.01)) +
  scale_fill_manual(values = c("Lanzarote" = "#d73027",
                               "Fuerteventura" = "#efc000",
                               "Gran Canaria" = "#1f78b4",
                               "Tenerife" = "#08306b",
                               "La Palma" = "#238b45",
                               "La Gomera & El Hierro" = "#8b5a2b")) +
  labs(title = "Tenerife was the most popular destination in 2024",
       subtitle = "Two out of five tourists visiting the Canary Islands in 2024 chose Tenerife for 
       their holiday. Gran Canaria had the second highest number of arrivals, followed by Lanzarote 
       and Fuerteventura. In contrast, La Gomera, La Palma and El Hierro together accounted for just 2.25% 
       of tourist arrivals last year.",
       x = element_blank(),
       y = element_blank(),
       caption = "Data: Instituto Canario de Estadística (ISTAC). | Made by Oliver Q.R.") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_line(colour = "grey97"),
        plot.title = element_text(colour = "#1c3d5a", face = "bold", size = 24),
        plot.subtitle = element_textbox_simple(colour = "#6d7b8d", size = 18,
                                     margin = margin(t = 2.5, b = 15)),
        plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 11),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(colour = "#666666", size = 16, margin = margin(r = 5)),
        axis.ticks.y = element_line(colour = "grey97"),
        legend.position = "none",
        plot.margin = margin(10, 10, 10, 10))
```

```{r}
# table
tour_by_island_2024 %>%
  arrange(desc(tourists)) %>%
  mutate(percent = round(percent, 2)) %>%
  gt() %>%
  tab_header(title = "Tourists arrived in the Canary Islands in 2024") %>%
  tab_style(style = list(
    cell_text(color = "white", weight = "bold", size = "x-large"),
    cell_fill(color = "#1c3d5a")
  ),
  locations = cells_title(groups = "title")) %>%
  cols_label(island = "Island",
             tourists = "Tourists",
             percent = "%") %>%
  tab_style(style = list(cell_text(color = "white", weight = "bold", size = "large"),
                         cell_fill(color = "#1c3d5a")),
            locations = cells_column_labels()) %>%
  tab_style(style = cell_text(align = "center"),
            locations = cells_column_labels(columns = c(tourists, percent))) %>%
  tab_style(style = cell_text(align = "center"),
            locations = cells_body(columns = c(tourists, percent))) %>%
  tab_style(style = cell_borders(color = "#bbc5ce", sides = "bottom"),
            locations = cells_body(rows = island != "La Palma")) %>%
  tab_source_note(source_note = "Data: Instituto Canario de Estadística (ISTAC) | Made by Oliver Q.R.") %>%
  tab_style(style = cell_text(color = "#6d7b8d", style = "italic", size = "small"),
            locations = cells_source_notes()) %>%
  tab_style(style = cell_text(size = "large"),
            locations = cells_body()) %>%
  fmt_number(columns = tourists,
             decimals = 0) %>%
  tab_options(table.font.names = "Poppins",
              heading.padding.horizontal = 10,
              column_labels.padding.horizontal = 10,
              data_row.padding.horizontal = 10,
              table.border.top.style = "none",
              table.border.bottom.style = "none",
              column_labels.border.top.color = "white",
              column_labels.border.bottom.style = "none",
              table_body.border.bottom.color = "#1c3d5a")
```

The most visited island in 2024 was Tenerife, with over 7.2 million visitors (40.3% of all tourists that visited the Canary Islands). Gran Canaria was the second most popular island, with 4.6 million tourists (25.54%), followed by Lanzarote (3.2 million; 18.03%) and Fuerteventura (2.5 million; 13.88%). At the other end, La Palma, with 170,147 tourist arrivals (0.95%), La Gomera and El Hierro (232,661 combined; 1.3%) were the islands with the fewest tourists.

## Yearly tourist arrivals by island.

```{r}
# Yearly tourist arrivals by island
# Canary Islands map
# downloading NUTS boundaries for the Canary Islands at the island level
canary_islands_map <- gisco_get_nuts(resolution = "03",
                                     country = "ES",
                                     year = "2024",
                                     nuts_level = "3") %>%
  filter(NUTS_NAME %in% c("Lanzarote", "Fuerteventura", "Gran Canaria", "Tenerife",
                          "La Gomera", "La Palma", "El Hierro"))


can_map <- canary_islands_map %>%
  filter(NUTS_NAME %in% c("La Gomera", "El Hierro")) %>%
  reframe(NAME_LATN = "La Gomera & El Hierro",
          CNTR_CODE = "ES",
          NUTS_NAME = "La Gomera & El Hierro",
          geometry = st_union(geometry)) %>%
  bind_rows(canary_islands_map %>%
              filter(!NUTS_NAME %in% c("La Gomera", "El Hierro"))) %>%
  select(island = NAME_LATN, geometry)


map <- can_map %>%
  ggplot() +
  geom_sf_interactive(aes(geometry = geometry, fill = island, data_id = island, tooltip = island)) +
  scale_fill_manual(values = c("Lanzarote" = "#d73027",
                               "Fuerteventura" = "#efc000",
                               "Gran Canaria" = "#1f78b4",
                               "Tenerife" = "#08306b",
                               "La Palma" = "#238b45",
                               "La Gomera & El Hierro" = "#8b5a2b")) +
  scale_x_continuous(breaks = -14:-18,
                     labels = paste0(abs(-14:-18), "°W")) +
  scale_y_continuous(breaks = seq(28, 29.5, 0.5),
                     labels = paste0(seq(28, 29.5, 0.5), "°N")) +
  theme_bw(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_line(colour = "grey97"),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 11),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(margin = margin(r = 5)),
        legend.position = "none",
        plot.margin = margin(10, 10, 10, 10))

#map


line_plot <- tourists_by_island %>%
  filter(country == "Total",
         year < 2025) %>%
  group_by(year, island) %>%
  summarise(tourists = sum(tourists, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = year, y = tourists, colour = island)) +
  geom_line(linewidth = 1.2) +
  geom_point_interactive(aes(fill = island, data_id = island, 
                             tooltip = paste0("<div style=text-align:center;>", island, "<br>", round(tourists/1e6, 1),"M</div>")), 
                         size = 3, shape = 21, colour = "white") +
  scale_colour_manual(values = c("Lanzarote" = "#d73027",
                                 "Fuerteventura" = "#efc000",
                                 "Gran Canaria" = "#1f78b4",
                                 "Tenerife" = "#08306b",
                                 "La Palma" = "#238b45",
                                 "La Gomera & El Hierro" = "#8b5a2b")) +
  scale_fill_manual(values = c("Lanzarote" = "#d73027",
                               "Fuerteventura" = "#efc000",
                               "Gran Canaria" = "#1f78b4",
                               "Tenerife" = "#08306b",
                               "La Palma" = "#238b45",
                               "La Gomera & El Hierro" = "#8b5a2b")) +
  scale_x_continuous(breaks = seq(2010, 2025, 2),
                     limits = c(2010, 2025),
                     expand = c(0.05, 0.01)) +
  scale_y_continuous(breaks = pretty_breaks(n = 8),
                     limits = c(0, 8e6), 
                     labels = label_number(scale = 1e-6, suffix = "M"),
                     expand = c(0.01, 0.01)) +
  labs(subtitle = "Tourists per year",
       x = element_blank(),
       y = "Tourists (millions)") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(colour = "grey97"),
        plot.subtitle = element_text(colour = "#6d7b8d", size = 16,
                                     margin = margin(t = 2.5, b = 15)),
        axis.title.y = element_text(size = 14, family = "Cabin", colour = "#555555",
                                    margin = margin(r = 10)),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 11),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(margin = margin(r = 5)),
        axis.ticks.y = element_line(colour = "grey97"),
        legend.position = "none",
        plot.margin = margin(10, 10, 10, 20))

#line_plot


bar_chart <- tourists_by_island %>%
  filter(country == "Total") %>%
  group_by(year, island) %>%
  summarise(tourists = sum(tourists, na.rm = TRUE), .groups = "drop") %>%
  filter(year %in% c(2010, 2024)) %>%
  pivot_wider(names_from = year,
              values_from = tourists,
              names_prefix = "tour_") %>%
  mutate(pct_change = 100 * (tour_2024 - tour_2010) / tour_2010,
         label = if_else(pct_change > 0,
                         paste0("+", round(pct_change, 1), "%"),
                         paste0(round(pct_change, 1), "%"))) %>%
  ggplot(aes(x = pct_change, y = fct_reorder(island, pct_change))) +
  geom_vline(xintercept = 0, colour = "#999999") +
  geom_col_interactive(aes(fill = island, data_id = island, tooltip = label)) +
  scale_fill_manual(values = c("Lanzarote" = "#d73027",
                               "Fuerteventura" = "#efc000",
                               "Gran Canaria" = "#1f78b4",
                               "Tenerife" = "#08306b",
                               "La Palma" = "#238b45",
                               "La Gomera & El Hierro" = "#8b5a2b")) +
  scale_x_continuous(breaks = c(-5, seq(0, 100, 10)),
                     limits = c(-7, 100),
                     expand = c(0.05, 0.1)) +
  labs(title = element_blank(),
       subtitle = "Change between 2010 - 2024",
       x = "%",
       y = element_blank()) +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_line(colour = "grey97"),
        plot.subtitle = element_text(colour = "#6d7b8d", size = 16,
                                     margin = margin(t = 2.5, b = 15)),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 11),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(colour = "#555555", size = 12, margin = margin(r = 5)),
        axis.ticks.y = element_line(colour = "grey97"),
        legend.position = "none",
        plot.margin = margin(10, 10, 20, 10))

#bar_chart


yearly_per_island_plot <- (bar_chart + line_plot) / map +
  plot_layout(heights = c(1, 1)) +
  plot_annotation(title = "Yearly tourist arrivals by island",
                  caption = "Data: Instituto Canario de Estadística (ISTAC). | Made by Oliver Q.R.",
                  theme = theme(plot.title = element_text(colour = "#1c3d5a", face = "bold", size = 24, hjust = 0.5),
                                plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
                                plot.margin = margin(10, 10, 10, 10)))


interactive_plot <- girafe(ggobj = yearly_per_island_plot,
                           width_svg = 10,
                           height_svg = 7) %>%
  girafe_options(opts_hover(css = "fill:rgb(60, 175, 194);stroke:black;"))

interactive_plot

#save_html(interactive_plot, "Graphs/yearly_per_island.html")
```

Tenerife is also the island with the largest increase in tourist arrivals over the past 15 years, with an impressive 84.2% rise since 2010. It is also the island with the steepest annual increase in arrivals post-COVID.<br>

Lanzarote experienced a 71.4% increase in visitors in 2024 compared to 2010. Fuerteventura and Gran Canaria followed, with a 67.2% and 58.2% rise, respectively, over the same period. These three islands, along with Tenerife, set all-time visitor records in 2024.<br>

Among the less popular islands, La Palma had a modest increase of 12.7%, while La Gomera & El Hierro (combined) saw a small decline of 5.1% in arrivals in 2024 compared to 2010.

## Country of origin.

In 2024, the majority of tourists (91.34%) visiting the Canary Islands came from just 14 European countries, with the United Kingdom leading by a significant margin. Over a third of all tourists that visited the islands in 2024 were from the UK, making up 34.9% of the total (\~6.2 million). Germany followed in second place, accounting for 15.9% of all tourists last year, whereas the mainland Spain ranked third with nearly 2 million visitors (11.2% of the total).

```{r}
# tourists by country of origin
tourists_can %>%
  filter(!country %in% c("Total", "Mundo (excluida España)")) %>%
  mutate(country = case_when(country == "Alemania" ~ "Germany",
                             country == "Bélgica" ~ "Belgium",
                             country == "Dinamarca" ~ "Denmark",
                             country == "España (excluida Canarias)" ~ "Spain",
                             country == "Finlandia" ~ "Finland",
                             country == "Francia" ~ "France",
                             country == "Irlanda" ~ "Ireland",
                             country == "Italia" ~ "Italy",
                             country == "Noruega" ~ "Norway",
                             str_detect(country, "Otros países") ~ "Other countries",
                             country == "Países Bajos" ~ "Netherlands",
                             country == "Reino Unido" ~ "United Kingdom",
                             country == "Suecia" ~ "Sweden",
                             country == "Suiza" ~ "Switzerland",
                             .default = country)) %>%
  group_by(year, country) %>%
  summarise(tourists = sum(tourists, na.rm = TRUE) / 1000000, .groups = "drop") %>%
  filter(year %in% c(2024, 2010)) %>%
  pivot_wider(names_from = year,
              values_from = tourists,
              names_prefix = "y") %>%
  mutate(change_percent = 100 * (y2024 - y2010) / y2010) %>%
  ggplot(aes(x = y2024, y = fct_reorder(country, y2024))) +
  geom_segment(aes(x = y2010, xend = y2024), colour = "#777777", linewidth = 1) +
  geom_point(aes(x = y2010, fill = "2010"), size = 5, shape = 21, colour = "white") +
  geom_point(aes(fill = "2024"), size = 5, shape = 21, colour = "white") +
  scale_fill_manual(values = c("2024" = "#1f78b4", "2010" = "#ef8a62"),
                      name = "Year") +
  scale_x_continuous(breaks = seq(0, 8, 1)) +
  labs(title = "British tourists are the largest nationality group visiting the Canary Islands",
       subtitle = "They are also the group with the largest increase over the last 15 years. Germans rank second 
       in number of visitors, followed by mainland Spaniards.",
       x = "Tourists (millions)",
       y = element_blank(),
       caption = "Data: Instituto Canario de Estadística (ISTAC). | Made by Oliver Q.R.") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(colour = "grey97"),
        plot.title = element_textbox_simple(colour = "#1c3d5a", face = "bold", size = 24),
        plot.subtitle = element_textbox_simple(colour = "#6d7b8d", size = 18,
                                         margin = margin(t = 5, b = 12.5)),
        plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 11),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(colour = "#666666", size = 16, margin = margin(r = 5)),
        axis.title.x = element_text(colour = "#666666", family = "Cabin", face = "bold", size = 13,
                                    margin = margin(t = 5)),
        axis.ticks = element_line(colour = "grey97"),
        legend.position = "inside",
        legend.position.inside = c(0.95, 0.1),
        legend.background = element_rect(linewidth = 0.2, fill = "white"),
        legend.title = element_text(face = "bold", hjust = 0.5),
        plot.margin = margin(10, 10, 10, 10))
```

Historically, the UK has been the largest source of tourists to the Canary Islands. This is something we could see in 2010 as well as in 2024. The UK is also the country that has experienced the largest increase in tourist numbers in absolute terms over the past 15 years (3.11 million, which is 101% more in 2024 compared to 2010).<br>

Germany, historically the second largest market, has seen a more modest increase since 2010, rising from 2.26 millions in 2010 to 2.82 in 2024 (a 24.9% rise). A similar trend can be see in tourists coming from mainland Spain, going from 1.71 million visitors in 2010 to 1.98 in 2024 (+16.1%).<br>

Among the 14 top source countries, France and Italy had the largest increase in relative terms (+348% and +264%, respectively) over the last 15 years. On the other hand, the number of tourists from Nordic countries has remained relatively stable over this period.

## Average daily expenditure.

```{r}
# average daily expenditure (tourist and day)
daily_exp %>%
  filter(is.na(quarter),
         concept == "Total",
         country == "Total") %>%
  ggplot(aes(x = year, y = avg_exp)) +
  annotate(geom = "segment", x = 2010, xend = 2024, y = 177, 
           colour = "grey80", linetype = "dotted") +
  annotate(geom = "segment", x = 2019, xend = 2024, y = 137, 
           colour = "grey80", linetype = "dotted") +
  geom_line(linewidth = 1.2, colour = "blue") +
  geom_point(size = 4, shape = 21, colour = "white", fill = "blue") +
  geom_segment(data = ~.x %>%
                 filter(year %in% c(2010, 2024)) %>%
                 summarise(x = min(year),
                           y = avg_exp[year == min(year)] + 2,
                           yend = avg_exp[year == max(year)] - 1),
               aes(x = x, y = y, yend = yend),
               inherit.aes = FALSE,
               colour = "grey75",
               arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "last")) +
  annotate(geom = "text", x = 2010.2, y = 145.5, label = "+55.26%", colour = "grey30", 
           fontface = "bold", angle = 90) +
  geom_segment(data = ~.x %>%
                 filter(year %in% c(2019, 2024)) %>%
                 summarise(x = max(year),
                           y = avg_exp[year == min(year)] + 1,
                           yend = avg_exp[year == max(year)] - 2),
               aes(x = x, y = y, yend = yend),
               inherit.aes = FALSE,
               colour = "grey75",
               arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "last")) +
  annotate(geom = "text", x = 2023.8, y = 157, label = "+29.2%", colour = "grey30", 
           fontface = "bold", angle = 90) +
  scale_x_continuous(breaks = 2010:2024,
                     expand = c(0.01, 0.01)) +
  scale_y_continuous(breaks = seq(100, 180, 10),
                     limits = c(100, 180)) +
  labs(title = "Tourists visiting the Canary Islands spend more each year",
       subtitle = "Average daily expenditure has risen significantly after COVID, with 
       the past three years setting all-time highs.",
       x = element_blank(),
       y = "Daily average expenditure per tourist (€)",
       caption = "Data: Instituto Canario de Estadística (ISTAC). | Made by Oliver Q.R.") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(colour = "grey97"),
        plot.title = element_text(colour = "#1c3d5a", face = "bold", size = 24),
        plot.subtitle = element_textbox_simple(colour = "#6d7b8d", size = 18,
                                     margin = margin(t = 2.5, b = 15)),
        plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 12),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(margin = margin(r = 5)),
        axis.title.y = element_text(size = 14, family = "Cabin", colour = "#555555",
                                    margin = margin(r = 10)),
        plot.margin = margin(10, 10, 10, 10))
```

Over the past 15 years, tourists visiting the Canary Islands have, on average, spent more each year (aside from the temporary mild drop during the COVID-19 pandemic). In 2024, the average daily expenditure per tourist and day was 55.3% higher than in 2010. A signifcant part of this increase has taken part in the post-COVID years. Thus, compared with 2019, daily spending per tourist and day rose by 29.2% in 2024. To put some context, accumulated inflation in Spain between 2010 and 2024 was 29.01%, whereas for the period 2019-2024 this was 19.08% (INE).

## Total annual income in the tourist sector.

```{r}
# Total income by the tourist sector
adr %>%
  filter(is.na(month),
         territory == "Canarias",
         variable == "Ingresos totales") %>%
  ggplot(aes(x = year, y = obs_value / 1000000)) +
  geom_rect(aes(xmin = 2009, xmax = 2013, ymin = -Inf, ymax = Inf), fill = "#dee5ec", alpha = 0.05) +
  geom_rect(aes(xmin = 2010, xmax = 2011, ymin = -Inf, ymax = Inf), fill = "#bfd7d7", alpha = 0.05) +
  geom_rect(aes(xmin = 2020, xmax = 2023, ymin = -Inf, ymax = Inf), fill = "#c4d3df", alpha = 0.025) +
  annotate(geom = "segment", x = 2009, xend = 2013, y = 1000, colour = "grey45",
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "last")) +
  annotate(geom = "text", x = 2011, y = 1200, colour = "black", size = 3.5, hjust = 0.5,
           label = "Global financial crisis") +
  annotate(geom = "segment", x = 2010, xend = 2011, y = 6000, colour = "grey45",
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "both")) +
  annotate(geom = "text", x = 2010.5, y = 5700, colour = "black", size = 3.5, hjust = 0.5,
           label = "Arab\nSpring") +
  annotate(geom = "segment", x = 2020, xend = 2023, y = 6000, colour = "grey45", 
           arrow = arrow(length = unit(0.2, "cm"), type = "open", ends = "both")) +
  annotate(geom = "text", x = 2021.5, y = 5700, colour = "black", size = 3.5, hjust = 0.5,
           label = "COVID-19 public health emergency\nof international concern") +
  geom_line(linewidth = 1.2, colour = "blue") +
  geom_point(size = 3, colour = "blue") +
  scale_x_continuous(breaks = 2009:2024,
                     limits = c(2009, 2024),
                     expand = c(0.01, 0.01)) +
  scale_y_continuous(breaks = pretty_breaks(n = 6),
                     limits = c(1000, 6000)) +
  labs(title = "Tourism income in the Canary Islands keeps breaking all-time records post-COVID",
       subtitle = "Total tourism income has reached unprecedented levels in the years post-COVID. 
       In 2024, for the first time ever, total income in the Canary Islands surpassed the €5,000 
       million mark. If this post-COVID trend continues, the €6,000 million mark could be exceeded 
       in 2025.",
       x = element_blank(),
       y = "Total income (million €)",
       caption = "Data: Exceltur. | Made by Oliver Q.R.") +
  theme_minimal(base_family = "Poppins") +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_line(colour = "grey97"),
        plot.title = element_textbox_simple(colour = "#1c3d5a", face = "bold", size = 24,
                                            margin = margin(b = 15)),
        plot.subtitle = element_textbox_simple(colour = "#6d7b8d", size = 18,
                                               margin = margin(t = 5, b = 20)),
        plot.caption = element_text(colour = "#6d7b8d", face = "italic", size = 10),
        axis.text = element_text(colour = "#999999", family = "Cabin", face = "bold", size = 12),
        axis.text.x = element_text(margin = margin(t = 5)),
        axis.text.y = element_text(margin = margin(r = 5)),
        axis.title.y = element_text(size = 14, family = "Cabin", colour = "#555555",
                                    margin = margin(r = 10)),
        plot.margin = margin(10, 10, 10, 10))
```

Over the period between 2009 and 2024 there is a clear long-term upward trend in total income, despite some year-to-year variation. Between 2009 until 2017, annual income grew steadily at rates between 6.6 and 15% every year, with the exception of 2012. This was followed by a slight drop in 2018 and virtually no change in 2019.<br>

The impact of COVID-19 in 2020 caused a sharp drop in income, but the recovery from 2021 onwards was quick and consistent. In fact, the period 2022-2024 have seen unprecedented figures, with the tourist sector breaking income records each year. By 2024, the total income had increased by 41.8% compared to pre-pandemic levels (2019), and by 157% compared to 2009.

# Wrap-up.

The numbers above point to a clear conclusion: the tourist sector in the Canary Island has never been stronger. Visitor numbers have reached record highs in recent years, particularly across the four main destinations: Tenerife, which is the most popular island, Gran Canaria, Lanzarote, and Fuerteventura. Tourists have never spent more than they did in 2024, and the industry has never generated as much income as last year. And looking at the current trend, 2025 may well be another record-breaking year.<br>

But, what does all of this mean for the locals? Are their living conditions improving alongside the booming tourist industry? And what about the environment? The Canary Islands are full of unique natural spaces that are also very fragile... and can easily be damaged if not properly protected.<br>

Are there signs of overtourism? Well, you might have heard or read something about protests claiming for a change in the current model. In the second part, soon to come, I'll go through some socioeconomic indicators to explore these questions further... and shed light on why many (myself included) believe it's time for a change. But that's for another post. Stay tuned!
